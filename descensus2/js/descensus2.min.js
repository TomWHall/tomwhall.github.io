/*!
 * Descensus 2 v1.0.2 demo
 * Copyright (c) Tom W Hall 2017
 */
(function(a){var c={};function __webpack_require__(d){if(c[d])return c[d].exports;var f=c[d]={i:d,l:!1,exports:{}};a[d].call(f.exports,f,f.exports,__webpack_require__);f.l=!0;return f.exports;}__webpack_require__.m=a;__webpack_require__.c=c;__webpack_require__.i=function(h){return h;};__webpack_require__.d=function(l,m,n){if(!__webpack_require__.o(l,m)){Object.defineProperty(l,m,{configurable:!1,enumerable:!0,get:n});}};__webpack_require__.n=function(o){var p=o&&o.__esModule?function getDefault(){return o['default'];}:function getModuleExports(){return o;};__webpack_require__.d(p,'a',p);return p;};__webpack_require__.o=function(q,s){return Object.prototype.hasOwnProperty.call(q,s);};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=35);})([function(t,u,v){"use strict";const w={ball:new p2.Material(),wood:new p2.Material(),brick:new p2.Material(),saw:new p2.Material()};Object.defineProperty(u,"__esModule",{value:!0});u.default=w;},function(z,A,B){"use strict";function updateBodyPosition(C,D,E=0){resetBody(C);const F=C.position;F[0]=D[0];F[1]=D[1];C.angle=E;C.updateAABB();C.updateBoundingRadius();}function resetBody(G){G.setZeroForce();G.velocity[0]=0;G.velocity[1]=0;G.angularVelocity=0;}function limitVelocity(H){const I=14,J=250,K=H.bodies;for(let i=0;i<K.length;i++){const L=K[i],M=L.velocity,N=Math.abs(M[0]),O=Math.abs(M[1]);if(N>I||O>I){const P=Math.min(I/N,I/O);M[0]*=P;M[1]*=P;}if(L.angularVelocity>J){L.angularVelocity=J;}else if(L.angularVelocity<-J){L.angularVelocity=-J;}}}Object.defineProperty(A,"__esModule",{value:!0});A.default={updateBodyPosition,resetBody,limitVelocity};},function(Q,R,S){"use strict";var T;(function(U){U[U["Girder"]=1]="Girder";U[U["Brick"]=2]="Brick";U[U["Seesaw"]=3]="Seesaw";U[U["Spinner"]=4]="Spinner";U[U["Snake"]=5]="Snake";U[U["FreeSaw"]=6]="FreeSaw";U[U["Saw"]=7]="Saw";U[U["SawSpinner"]=8]="SawSpinner";U[U["SawSnake"]=9]="SawSnake";U[U["Plus1Life"]=10]="Plus1Life";})(T||(T={}));Object.defineProperty(R,"__esModule",{value:!0});R.default=T;},function(V,W,X){"use strict";const Y=X(1);class TerrainObject{constructor(Z,a1,b1){this.active=!1;this.suspended=!1;this.type=Z;this.world=a1;this.pixiGraph=b1;this.bodies=[];this.constraints=[];}addBody(c1,d1,e1){d1.anchor=new PIXI.ObservablePoint(null,null,0.5,0.5);d1.visible=!1;c1.sprite=d1;e1.addChild(d1);c1.terrainObject=this;this.bodies.push(c1);}addBodyHidden(f1){f1.terrainObject=this;this.bodies.push(f1);}addShape(g1,h1,i1){i1=i1||{};const j1=i1.offset||[0,0],k1=i1.angle||0;h1.collisionGroup=i1.collisionOptions&&i1.collisionOptions.collisionGroup||1;h1.collisionMask=i1.collisionOptions&&i1.collisionOptions.collisionMask||1;g1.addShape(h1,j1,k1);}addConstraint(l1){this.constraints.push(l1);}getAABB(){const m1=new p2.AABB();for(let i=0,body;i<this.bodies.length;i++){body=this.bodies[i];if(body.aabbNeedsUpdate){body.updateAABB();}if(i===0){m1.copy(body.aabb);}else{m1.extend(body.aabb);}}return m1;}activate(...args){const n1=this.world,o1=this.bodies;for(let i=0,body;i<o1.length;i++){body=o1[i];n1.addBody(body);const p1=body.sprite;if(!p1)continue;p1.visible=!0;}const q1=this.constraints;for(let j=0;j<q1.length;j++){n1.addConstraint(q1[j]);}this.resume();this.active=!0;}deactivate(){const r1=this.world,s1=this.constraints;for(let i=0;i<s1.length;i++){r1.removeConstraint(s1[i]);}const t1=this.bodies;for(let j=0,body;j<t1.length;j++){body=t1[j];body.setZeroForce();body.velocity[0]=0;body.velocity[1]=0;body.angularVelocity=0;r1.removeBody(body);const u1=body.sprite;if(u1){u1.visible=!1;}}this.active=!1;}suspend(){const v1=this.bodies;for(let i=0,body;i<v1.length;i++){body=v1[i];if(body.allowSleep){body.sleep();}body.collisionResponse=!1;}this.suspended=!0;}resume(){const w1=this.bodies;for(let i=0,body;i<w1.length;i++){body=w1[i];if(body.allowSleep){body.wakeUp();Y.default.resetBody(body);}body.collisionResponse=!0;}this.suspended=!1;}}Object.defineProperty(W,"__esModule",{value:!0});W.default=TerrainObject;},function(z1,A1,B1){"use strict";const C1={};function subscribe(D1,E1){if(!C1[D1]){C1[D1]=[];}if(C1[D1].indexOf(E1)===-1){C1[D1].push(E1);}}function unsubscribe(F1,G1){if(!C1[F1])return;var H1=C1[F1].indexOf(G1);if(H1!==-1){C1[F1].splice(H1,1);}}function publish(I1,J1){var K1=C1[I1];if(K1){for(var i=0,subscriber;i<K1.length;i++){subscriber=K1[i];subscriber(J1);}}}Object.defineProperty(A1,"__esModule",{value:!0});A1.default={subscribe,unsubscribe,publish};},function(L1,M1,N1){"use strict";function getAnchor(O1){const P1=new p2.Body({mass:100});P1.gravityScale=0;const Q1=new p2.Circle({radius:0.1});Q1.sensor=!0;P1.addShape(Q1);P1.terrainObject=O1.terrainObject;return P1;}function getAnchorConstraint(R1,S1,T1,U1=!1){T1=T1||[0,0];const V1=new p2.RevoluteConstraint(R1,S1,{localPivotA:T1,localPivotB:[0,0]});V1.collideConnected=!1;if(U1){V1.enableMotor();}return V1;}Object.defineProperty(M1,"__esModule",{value:!0});M1.default={getAnchor,getAnchorConstraint};},function(W1,X1,Y1){"use strict";const Z1=1,a2=new MersenneTwister(Z1);function reseed(){a2.seed(Z1);}function random0To1(){return a2.rnd();}function randomNeg1ToPos1(){return(a2.rnd()-0.5)*2;}function randomSign(){return randomInt(1,2)===1?-1:1;}function randomInt(b2,c2){const r=a2.rnd();return Math.floor(r*(c2-b2+1))+b2;}function randomBoolean(){return randomInt(1,2)===1;}Object.defineProperty(X1,"__esModule",{value:!0});X1.default={reseed,random0To1,randomNeg1ToPos1,randomSign,randomInt,randomBoolean};},function(d2,e2,f2){"use strict";var g2;(function(h2){h2[h2["blue"]=6724095]="blue";h2[h2["yellow"]=16108847]="yellow";h2[h2["orange"]=16607755]="orange";h2[h2["red"]=16729156]="red";})(g2||(g2={}));Object.defineProperty(e2,"__esModule",{value:!0});e2.default=g2;},function(i2,j2,k2){"use strict";const l2=k2(4);let m2=null,n2=!1,o2=!1;l2.default.subscribe('Sound.Toggle',()=>{toggle();});function initialize(q2){m2=q2;n2=!0;o2=!0;for(let r2 in m2){const s2=m2[r2];s2.hackPlaying=!1;s2.hackPaused=!0;s2.onplaying=()=>{s2.hackPlaying=!0;s2.hackPaused=!1;};s2.onpause=()=>{s2.hackPlaying=!1;s2.hackPaused=!0;};}}function play(t2,u2=!1){if(!n2||!o2)return;const v2=m2[t2];if(!u2){v2.currentTime=0;}if(v2.hackPaused){if(v2===m2.clock){v2.loop=!0;}v2.play();}}function pause(w2){if(!n2)return;const z2=m2[w2];if(!z2.hackPaused){z2.pause();};}function stop(A2){if(!n2)return;const B2=m2[A2];B2.pause();B2.currentTime=0;}function pauseAll(){for(let C2 in m2){pause(C2);}}function resumeAll(){for(let D2 in m2){const E2=m2[D2];if(E2.paused&&E2.currentTime>0&&!E2.ended){play(D2,!0);}}}function stopAll(){for(let F2 in m2){stop(F2);}}function toggle(){if(!n2)return;o2=!o2;l2.default.publish('Sound.Enable',o2);}Object.defineProperty(j2,"__esModule",{value:!0});j2.default={initialize,play,pause,stop,pauseAll,resumeAll,stopAll,toggle};},function(G2,H2,I2){"use strict";const J2=I2(2),K2=I2(6),L2=I2(32),M2=I2(26),N2=I2(24),O2=I2(31),P2=I2(13),Q2=I2(12),R2=I2(25),S2=I2(28),T2=I2(30),U2=I2(29),V2=I2(27);let W2,X2,Y2,Z2,a3,b3,c3,d3,e3,f3,g3,h3,i3=[];const j3={},k3=[];const l3=[{startY:600,endY:575,strength:1.5},{startY:500,endY:475,strength:-1.75},{startY:350,endY:325,strength:2},{startY:275,endY:250,strength:-2.25},{startY:100,endY:75,strength:2.5},{startY:75,endY:50,strength:-2.75}];function createTerrainObjects(m3,n3){const o3=[];for(let i=0;i<n3;i++){o3.push(m3());}return o3;}function getActiveCount(p3){let q3=0;for(let i=0;i<p3.length;i++){if(p3[i].active)q3++;}return q3;}function initialize(r3,s3,t3){W2=r3;X2=s3;Y2=createTerrainObjects(()=>new M2.default(W2,s3,t3),20);Z2=createTerrainObjects(()=>new N2.default(W2,s3,t3),6);a3=createTerrainObjects(()=>new O2.default(W2,s3,t3),8);b3=createTerrainObjects(()=>new P2.default(W2,s3,t3),8);c3=createTerrainObjects(()=>new R2.default(W2,s3,t3),4);d3=createTerrainObjects(()=>new S2.default(W2,s3,t3),20);e3=createTerrainObjects(()=>new T2.default(W2,s3,t3),8);h3=createTerrainObjects(()=>new V2.default(W2,s3,t3),2);f3=createTerrainObjects(()=>{const u3=0.5+K2.default.random0To1(),v3=(1+K2.default.random0To1())*1000;return new Q2.default(W2,s3,t3,u3,v3);},8);g3=createTerrainObjects(()=>{const w3=0.5+K2.default.random0To1(),x3=(1+K2.default.random0To1())*1000;return new U2.default(W2,s3,t3,w3,x3);},6);i3=f3.concat(g3);j3[J2.default.Girder]=Y2;j3[J2.default.Brick]=Z2;j3[J2.default.Seesaw]=a3;j3[J2.default.Spinner]=b3;j3[J2.default.FreeSaw]=c3;j3[J2.default.Saw]=d3;j3[J2.default.SawSpinner]=e3;j3[J2.default.Snake]=f3;j3[J2.default.SawSnake]=g3;j3[J2.default.Plus1Life]=h3;k3.push.apply(k3,[Y2,Z2,a3,b3,f3,c3,d3,e3,g3,h3]);}function update(y3,z3){const A3=16,B3=new p2.AABB();B3.lowerBound[0]=z3.lowerBound[0]-A3;B3.lowerBound[1]=z3.lowerBound[1]-A3;B3.upperBound[0]=z3.upperBound[0]+A3;B3.upperBound[1]=z3.upperBound[1]+A3;setObjectStates(z3,B3);L2.default.updateAABBs(W2);const C3=z3.lowerBound[0],D3=z3.upperBound[0],E3=z3.upperBound[1],F3=z3.lowerBound[1],G3=B3.lowerBound[0],H3=B3.upperBound[0],I3=B3.upperBound[1],J3=B3.lowerBound[1],K3=new p2.AABB({lowerBound:[G3,E3],upperBound:[H3,I3]}),L3=new p2.AABB({lowerBound:[G3,J3],upperBound:[H3,F3]}),M3=new p2.AABB({lowerBound:[G3,F3],upperBound:[C3,E3]}),N3=new p2.AABB({lowerBound:[D3,F3],upperBound:[H3,E3]});populateArea(K3);populateArea(L3);populateArea(M3);populateArea(N3);dropBricks(K3);throwSaws(M3,N3,L3);applyWind(y3);agitateSnakes();}function deployTerrainObject(O3,P3,Q3,R3,S3,T3,...args){const U3=j3[O3];if(getActiveCount(U3)<P3){for(let i=0;i<U3.length;i++){const V3=U3[i];if(!V3.active){const W3=L2.default.getRandomPosition(W2,Q3,R3,S3,T3);if(W3!==null){const X3=[W3].concat(args);V3.activate.apply(V3,X3);}return;}}throw new Error('TerrainObjectPool of type '+O3+' empty');}}function deployGirder(Y3,Z3,a4){const b4=K2.default.random0To1()*(Math.PI*2);deployTerrainObject(J2.default.Girder,Z3,Y3,5,5,a4,b4);}function deployBrick(c4,d4,e4){const f4=K2.default.random0To1()*(Math.PI*2);deployTerrainObject(J2.default.Brick,d4,c4,5,5,e4,f4);}function deploySeesaw(g4,h4,i4){const j4=K2.default.randomBoolean(),k4=j4?1:6,l4=j4?6:1;deployTerrainObject(J2.default.Seesaw,h4,g4,k4,l4,i4,j4);}function deploySpinner(m4,n4,o4){const p4=K2.default.randomInt(200,250)*K2.default.randomSign();deployTerrainObject(J2.default.Spinner,n4,m4,7,7,o4,p4);}function deploySnake(q4,r4,s4){const t4=K2.default.randomInt(40,60)*K2.default.randomSign(),u4=K2.default.randomInt(2500,5000);deployTerrainObject(J2.default.Snake,r4,q4,0.5,14.5,s4,t4,u4);}function deployFreeSaw(v4,w4,x4,y4){deployTerrainObject(J2.default.FreeSaw,w4,v4,1,1,x4,y4);}function deploySaw(z4,A4,B4){deployTerrainObject(J2.default.Saw,A4,z4,2,2,B4);}function deploySawSpinner(C4,D4,E4){const F4=K2.default.randomInt(200,250)*K2.default.randomSign();deployTerrainObject(J2.default.SawSpinner,D4,C4,9,9,E4,F4);}function deploySawSnake(G4,H4,I4){const J4=K2.default.randomInt(40,60)*K2.default.randomSign(),K4=K2.default.randomInt(2500,5000);deployTerrainObject(J2.default.SawSnake,H4,G4,2,14.5,I4,J4,K4);}function deployPlus1Life(L4,M4,N4){deployTerrainObject(J2.default.Plus1Life,M4,L4,2,2,N4);}function populateArea(O4){const P4=L2.default.getMidHeight(O4),Q4=L2.default.getCountLessAsDescends(P4,4,6,1000);deploySawSnake(O4,L2.default.getCountMoreAsDescends(P4,3,6,250),Q4);deploySawSpinner(O4,L2.default.getCountLessAsDescends(P4,2,8,500),Q4);deploySnake(O4,L2.default.getCountLessAsDescends(P4,1,8,600),Q4);deploySpinner(O4,L2.default.getCountLessAsDescends(P4,1,8,800),Q4);deploySeesaw(O4,L2.default.getCountLessAsDescends(P4,1,8,900),Q4);deployGirder(O4,L2.default.getCountLessAsDescends(P4,1,20,1000),Q4);deploySaw(O4,L2.default.getCountLessAsDescends(P4,20,2,1000),Q4);deployPlus1Life(O4,L2.default.getCountMoreAsDescends(P4,1,2,500),Q4);}function dropBricks(R4){const S4=L2.default.getMidHeight(R4),T4=L2.default.getCountMoreAsDescends(S4,2,6,975);if(T4===0)return;const U4=new p2.AABB();U4.copy(R4);U4.upperBound[1]-=12;U4.lowerBound[0]+=4;U4.upperBound[0]-=4;deployBrick(R4,T4,1);}function throwSaws(V4,W4,X4){const Y4=L2.default.getMidHeight(V4),Z4=L2.default.getCountMoreAsDescends(Y4,2,4,975);if(Z4===0)return;{const a5=K2.default.randomBoolean(),b5=new p2.AABB();b5.copy(a5?V4:W4);b5.lowerBound[1]+=14;if(a5){b5.lowerBound[0]+=13;}else{b5.upperBound[0]-=13;}const c5=10,d5=K2.default.random0To1(),e5=a5?[c5,d5]:[-c5,d5];deployFreeSaw(b5,Z4,1,e5);}{const f5=new p2.AABB();f5.copy(X4);f5.lowerBound[1]+=25;f5.lowerBound[0]+=4;f5.upperBound[0]-=4;const g5=20,h5=K2.default.random0To1(),i5=[h5,g5];deployFreeSaw(X4,Z4,1,i5);}}function applyWind(j5){let k5=[];const l5=W2.bodies;for(let j=0;j<l5.length;j++){const m5=l5[j];if(m5.sprite&&m5.sprite.visible){k5.push(m5);}}X2.windLeft.visible=!1;X2.windRight.visible=!1;const n5=j5.position[1];for(let i=0;i<l3.length;i++){const o5=l3[i];if(n5<=o5.startY&&n5>=o5.endY){for(let k=0;k<k5.length;k++){const p5=k5[k];p5.applyForce([o5.strength,0],[0,0]);}if(o5.strength<0){X2.windRight.visible=!0;}else{X2.windLeft.visible=!0;}break;}}}function agitateSnakes(){for(let i=0;i<i3.length;i++){const q5=i3[i];if(q5.active){q5.agitate();}}}function setObjectStates(r5,s5){for(let i=0;i<k3.length;i++){const t5=k3[i];for(let j=0;j<t5.length;j++){const u5=t5[j];if(u5.active){const v5=u5.getAABB();if(v5.upperBound[0]<s5.lowerBound[0]||v5.lowerBound[0]>s5.upperBound[0]||v5.lowerBound[1]>s5.upperBound[1]||v5.upperBound[1]<s5.lowerBound[1]){u5.deactivate();}else if(v5.upperBound[0]<r5.lowerBound[0]||v5.lowerBound[0]>r5.upperBound[0]||v5.lowerBound[1]>r5.upperBound[1]||v5.upperBound[1]<r5.lowerBound[1]){u5.suspend();}else{if(u5.suspended){u5.resume();}}}}}}function deactivateAll(){for(let i=0;i<k3.length;i++){const w5=k3[i];for(let j=0;j<w5.length;j++){const x5=w5[j];if(x5.active){x5.deactivate();}}}}Object.defineProperty(H2,"__esModule",{value:!0});H2.default={initialize,update,deactivateAll};},function(y5,z5,A5){"use strict";const B5=A5(0),C5=A5(1),D5=A5(4);let E5,F5,G5,H5,I5,J5,K5,L5,M5,N5,O5=!1;function initialize(P5,Q5,R5){E5=Q5.stage;F5=Q5.container;G5=Q5.barContainer;K5=new p2.Body({mass:20000,position:[-999999,0]});K5.gravityScale=0;K5.allowSleep=!1;L5=new p2.Box({width:0.25,height:0.25});L5.material=B5.default.wood;K5.addShape(L5);M5=new PIXI.Sprite(R5.bar);M5.width=L5.width*64;M5.height=L5.height*64;M5.anchor=new PIXI.ObservablePoint(null,null,0.5,0.5);Q5.barContainer.addChild(M5);K5.sprite=M5;N5=!0;P5.addBody(K5);P5.on('beginContact',beginContact,this);addTouchHandlers();}function click(e){if(!N5)return;N5=!1;L5.sensor=!0;const S5=e.data.getLocalPosition(E5);H5=getWorldPosition(S5);I5=[H5[0],H5[1]];J5=new PIXI.Point(S5.x,S5.y);update();}function drag(e){if(N5)return;const T5=e.data.getLocalPosition(E5);J5.x=T5.x;J5.y=T5.y;L5.sensor=!1;}function update(){if(N5)return;const U5=getWorldPosition(J5);if(U5[0]===I5[0]&&U5[1]===I5[1])return;I5[0]=U5[0];I5[1]=U5[1];const x1=H5[0],y1=H5[1],x2=I5[0],y2=I5[1],Z5=x2-x1,a6=y2-y1;K5.position[0]=(x1+x2)/2;K5.position[1]=(y1+y2)/2;K5.angle=Math.atan2(a6,Z5);const b6=Math.max(0.25,Math.sqrt(Z5*Z5+a6*a6));L5.width=b6;const c6=L5;c6.vertices[0][0]=-b6/2;c6.vertices[0][1]=-0.125;c6.vertices[1][0]=b6/2;c6.vertices[1][1]=-0.125;c6.vertices[2][0]=b6/2;c6.vertices[2][1]=0.125;c6.vertices[3][0]=-b6/2;c6.vertices[3][1]=0.125;c6.updateTriangles();c6.updateCenterOfMass();c6.updateBoundingRadius();c6.updateArea();K5.updateAABB();K5.updateBoundingRadius();M5.position.x=K5.position[0]*64;M5.position.y=-K5.position[1]*64;M5.width=b6*64;}function finalize(){if(N5)return;update();window.setTimeout(()=>{C5.default.resetBody(K5);},50);N5=!0;}function hide(){C5.default.updateBodyPosition(K5,[-999999,0]);}function getWorldPosition(d6){const e6=F5.position;return[(d6.x-e6.x)/64,(e6.y-d6.y)/64];}function addTouchHandlers(){function onTouch(e){if(!O5)return;click(e);}function onDrag(e){if(!O5)return;drag(e);}function onRelease(e){if(!O5)return;finalize();}G5.on('touchstart',onTouch);G5.on('touchmove',onDrag);G5.on('touchend',onRelease);G5.on('touchendoutside',onRelease);G5.on('mousedown',onTouch);G5.on('mousemove',onDrag);G5.on('mouseup',onRelease);G5.on('mouseupoutside',onRelease);}function beginContact(f6){if(N5)return;const g6=f6.bodyA,h6=f6.bodyB,i6=K5;if(!(g6===i6||h6===i6))return;if(L5.sensor){hide();return;}finalize();}D5.default.subscribe('State.IsActive',j6=>{O5=j6;});Object.defineProperty(z5,"__esModule",{value:!0});z5.default={initialize,update,finalize,hide};},function(k6,l6,m6){"use strict";const n6=16,o6=28,p6=64,q6=n6*p6,r6=o6*p6,s6={transparent:!1,backgroundColor:0x000000},t6=new PIXI.WebGLRenderer(q6,r6,s6),u6=t6.view;u6.id='viewport';u6.style.display='none';u6.style.marginLeft='auto';u6.style.marginRight='auto';document.body.appendChild(u6);function resizeView(){resize(t6);}window.addEventListener('resize',()=>{resizeView();});window.addEventListener('orientationchange',()=>{resizeView();});resizeView();function resize(v6){const w6=window.innerWidth,x6=window.innerHeight,y6=v6.view,z6=w6/x6,A6=v6.width/v6.height;if(z6>A6){y6.style.width=Math.floor(x6*A6)+'px';y6.style.height=x6+'px';}else{y6.style.width=w6+'px';y6.style.height=Math.floor(w6/A6)+'px';}}Object.defineProperty(l6,"__esModule",{value:!0});l6.default=t6;},function(B6,C6,D6){"use strict";const E6=D6(3),F6=D6(2),G6=D6(0),H6=D6(5),I6=D6(1);class Snake extends E6.default{constructor(J6,K6,L6,M6,N6){super(F6.default.Snake,J6,K6);this.segmentCount=4;this.segments=[];this.agitateCycle=N6;let O6=null;for(let i=0,twoByFourBody;i<this.segmentCount;i++){twoByFourBody=new p2.Body({mass:0.5});twoByFourBody.gravityScale=0;const P6=new PIXI.Sprite(L6.twoByFour);this.addBody(twoByFourBody,P6,K6.twoByFourContainer);this.segments.push(twoByFourBody);const Q6=new p2.Box({width:0.5,height:4});Q6.material=G6.default.wood;this.addShape(twoByFourBody,Q6);if(O6===null){const R6=this.anchorBody=H6.default.getAnchor(twoByFourBody);this.addBodyHidden(R6);const S6=this.anchorConstraint=H6.default.getAnchorConstraint(twoByFourBody,R6,[1.75,0],!0);this.addConstraint(S6);}else{const T6=new p2.RevoluteConstraint(twoByFourBody,O6,{localPivotA:[0,1.75],localPivotB:[0,-1.75]});T6.collideConnected=!1;const U6=Math.PI/4;T6.setLimits(-U6,U6);this.addConstraint(T6);}O6=twoByFourBody;}}scheduleAgitate(){this.nextAgitateTime=performance.now()+this.agitateCycle;}agitate(){if(!this.active||performance.now()<this.nextAgitateTime)return;this.anchorConstraint.setMotorSpeed(-this.anchorConstraint.getMotorSpeed());this.scheduleAgitate();}activate(V6,W6,X6){super.activate();const Y6=this.segmentCount*3.5+0.5,Z6=[V6[0],V6[1]+Y6/2-2];I6.default.updateBodyPosition(this.anchorBody,[Z6[0],Z6[1]+1.75]);const a7=this.segments;for(let i=0;i<a7.length;i++){I6.default.updateBodyPosition(a7[i],[Z6[0],Z6[1]-i*3.5]);}this.anchorConstraint.setMotorSpeed(W6);this.agitateCycle=X6;this.scheduleAgitate();}}Object.defineProperty(C6,"__esModule",{value:!0});C6.default=Snake;},function(b7,c7,d7){"use strict";const e7=d7(3),f7=d7(2),g7=d7(0),h7=d7(5),i7=d7(1);class Spinner extends e7.default{constructor(j7,k7,l7){super(f7.default.Spinner,j7,k7);const m7=new p2.Body({mass:6});m7.gravityScale=0;const n7=new PIXI.Sprite(l7.spinner);n7.isSpinner=!0;this.addBody(m7,n7,k7.spinnerContainer);this.spinnerBody=m7;const o7=new p2.Box({width:6,height:1});o7.material=g7.default.wood;this.addShape(m7,o7);const p7=new p2.Box({width:6,height:1});p7.material=g7.default.wood;this.addShape(m7,p7,{angle:-Math.PI/2});const q7=this.anchorBody=h7.default.getAnchor(m7);this.addBodyHidden(q7);const r7=this.anchorConstraint=h7.default.getAnchorConstraint(m7,q7,null,!0);this.addConstraint(r7);}activate(s7,t7){super.activate();i7.default.updateBodyPosition(this.spinnerBody,s7);i7.default.updateBodyPosition(this.anchorBody,s7);this.anchorConstraint.setMotorSpeed(t7);}}Object.defineProperty(c7,"__esModule",{value:!0});c7.default=Spinner;},function(u7,v7,w7){"use strict";var x7=new Promise((y7,z7)=>{const A7=new PIXI.loaders.Loader();A7.add('Constantia','fonts/Constantia/Constantia.fnt');A7.load((B7,C7)=>{y7();});});Object.defineProperty(v7,"__esModule",{value:!0});v7.default=x7;},function(D7,E7,F7){"use strict";var G7=new Promise((H7,I7)=>{const J7=document.createElement('audio'),K7=!!(J7.canPlayType&&J7.canPlayType('audio/mpeg;').replace(/no/,'')),L7=!!(J7.canPlayType&&J7.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,''));if(!K7&&!L7){I7('Neither MP3 nor OGG supported');return;}const M7=1;let N7=0;const O7=K7?'.mp3':'.ogg',P7={saw:loadSound('saw'),checkpoint:loadSound('checkpoint'),lostLife:loadSound('lost-life'),gainedLife:loadSound('gained-life'),clock:loadSound('clock'),alarm:loadSound('alarm'),lost:loadSound('lost')};function loadSound(Q7){const R7=new Audio();R7.src='sound/'+Q7+O7;R7.addEventListener('canplaythrough',function(){N7++;if(N7===M7){H7(P7);}});R7.load();return R7;}});Object.defineProperty(E7,"__esModule",{value:!0});E7.default=G7;},function(S7,T7,U7){"use strict";var V7=new Promise((W7,X7)=>{const Y7=new PIXI.loaders.Loader();Y7.add('ball','img/ball.png');Y7.add('ballReflections','img/ball-reflections.png');Y7.add('girder','img/girder.png');Y7.add('brick','img/brick.png');Y7.add('seesaw','img/seesaw.png');Y7.add('spinner','img/spinner.png');Y7.add('saw','img/saw.png');Y7.add('sawSmall','img/saw-small.png');Y7.add('twoByFour','img/two-by-four.png');Y7.add('clouds','img/clouds.jpg');Y7.add('bar','img/bar.png');Y7.add('helpHand','img/help-hand.png');Y7.add('plus1Life','img/plus-1-life.png');Y7.add('windLeft','img/wind-left.png');Y7.add('windRight','img/wind-right.png');Y7.add('timeBar','img/time-bar.png');Y7.add('timeBarTime','img/time-bar-time.png');Y7.load((Z7,a8)=>{const b8={};for(var c8 in a8){b8[c8]=a8[c8].texture;}W7(b8);});});Object.defineProperty(T7,"__esModule",{value:!0});T7.default=V7;},function(d8,e8,f8){"use strict";const g8=f8(22),h8=f8(6),i8=f8(8),j8=f8(11),k8=f8(10),l8=f8(9),m8=f8(7),n8=f8(34),o8=f8(1),p8=f8(4),q8=400,r8=3;let s8=q8,t8=r8,u8=null,v8=null,w8,x8=!1,y8=null,z8,A8=[],B8=null,C8=null,D8,E8=new p2.AABB(),F8,G8,H8,I8;function initialize(J8,K8,L8){B8=J8;C8=K8;D8=L8;document.addEventListener('visibilitychange',handleVisibilityChange,!1);C8.terrainContainer.visible=!1;H8=g8.default.Active;setState(g8.default.Intro);i8.default.play('saw');requestAnimationFrame(animate);}function handleVisibilityChange(e){const M8=e.target,N8=M8.visibilityState;if(N8==='visible'){F8=performance.now();i8.default.resumeAll();setState(I8);}else{I8=G8;i8.default.pauseAll();setState(g8.default.PageHidden);}}function animate(O8){requestAnimationFrame(animate);if(G8===g8.default.PageHidden)return;const P8=1/60;let Q8=O8-(F8||O8);F8=O8;switch(G8){case g8.default.Active:const R8=C8.container.position,S8=D8.position[0],T8=D8.position[1];processInvincibility(Q8);updateScreenAABB();k8.default.update();l8.default.update(D8,E8);B8.step(P8,Q8/1000,5);o8.default.limitVelocity(B8);processHeightChange(T8);processCheckpoints(T8,Q8);setScroll(S8,T8,R8);updateTransforms();Q8;break;case g8.default.Dying:processLifeLostAnimation(Q8);break;case g8.default.Won:processGameWonAnimation(Q8);break;case g8.default.Lost:processGameLostAnimation(Q8);break;}j8.default.render(C8.stage);}function processHeightChange(U8){if(U8<=0)return;const V8=Math.round(U8);if(V8!==s8){s8=V8;p8.default.publish('Height.Set',s8);}}function processCheckpoints(W8,X8){if(W8<=q8-100){gameWon();return;};if(v8===null||W8<=v8){v8=Math.floor(W8/100)*100;if(v8===W8){v8-=100;}u8=0;p8.default.publish('NextCheckpointHeight.Set',v8);i8.default.stop('clock');w8=!1;i8.default.play('checkpoint');}else{u8+=X8;}let Y8=1-u8/30000;if(Y8<=0){u8=0;Y8=0;i8.default.stop('clock');w8=!1;lostLife(null);}else if(Y8<=1/3&&!w8){i8.default.play('clock');w8=!0;}p8.default.publish('TimeRemainingQuotient.Set',Y8);}function processInvincibility(Z8){if(x8){y8+=Z8;if(y8>3000){y8=0;x8=!1;p8.default.publish('IsInvincible.Set',x8);}}}function setScroll(a9,b9,c9){c9.x=j8.default.width/2-a9*64;c9.y=640+b9*64;const d9=C8.background.position;d9.x=(c9.x+10000000)/2%1024;d9.y=(c9.y+10000000)/2%1024;}function updateTransforms(){const e9=64,f9=B8.bodies;for(let i=0;i<f9.length;i++){const g9=f9[i];if(g9.aabbNeedsUpdate){g9.updateAABB();}const h9=g9.aabb,i9=g9.interpolatedPosition,j9=!(h9.lowerBound[1]>E8.upperBound[1]||h9.upperBound[1]<E8.lowerBound[1]||h9.upperBound[0]<E8.lowerBound[0]||h9.lowerBound[0]>E8.upperBound[0]),k9=g9.sprite;if(k9){const l9=k9.position;l9.x=i9[0]*e9;l9.y=-i9[1]*e9;k9.rotation=-g9.interpolatedAngle;k9.visible=j9;}const m9=g9.spriteReflection;if(m9){const n9=m9.position;n9.x=i9[0]*e9;n9.y=-i9[1]*e9;m9.visible=j9;}}}function processLifeLostAnimation(o9){const p9=1000/o9*1.5,q9=1/p9;C8.playerBallContainer.alpha-=q9;if(C8.playerBallContainer.alpha<=0){n8.default.untintSprite(D8.sprite);n8.default.untintSprite(D8.spriteReflection);if(z8){z8.deactivate();n8.default.untintTerrainObject(z8);z8=null;}C8.playerBallContainer.alpha=1;o8.default.resetBody(D8);if(t8<=0){gameLost();return;}setState(g8.default.Active);x8=!0;p8.default.publish('IsInvincible.Set',x8);i8.default.resumeAll();}}function getVisibleSprites(){const r9=C8.terrainContainer.children.map(s9=>s9 instanceof PIXI.Sprite?[s9]:s9.children.filter(t9=>t9.visible));return[C8.background].concat(C8.barContainer.children[0]).concat(...r9);}function lostLife(u9){t8--;p8.default.publish('Lives.Set',t8);k8.default.finalize();setState(g8.default.Dying);i8.default.pauseAll();if(u9){i8.default.play('lostLife');}else{i8.default.play('alarm');}}function gameLost(){setState(g8.default.Lost);i8.default.stopAll();i8.default.play('lost');A8=getVisibleSprites();for(let i=0;i<A8.length;i++){n8.default.tintSprite(A8[i],m8.default.red);}}function processGameLostAnimation(v9){const w9=1000/v9*3,x9=1/w9;C8.background.alpha-=x9;C8.container.alpha-=x9;if(C8.container.alpha<=0){setState(g8.default.DemoEnd);i8.default.stopAll();C8.background.visible=!1;C8.container.visible=!1;p8.default.publish('Menu.RequestDemoEndPanel');}}function gameWon(){setState(g8.default.DemoEnd);i8.default.stopAll();C8.background.visible=!1;C8.container.visible=!1;p8.default.publish('Menu.RequestDemoEndPanel');}function processGameWonAnimation(y9){p8.default.publish('Menu.IncrementGameWonPanelAlpha',y9);}function updateScreenAABB(){const z9=D8.position,A9=z9[0],B9=z9[1];E8.lowerBound[0]=A9-8;E8.lowerBound[1]=B9-18;E8.upperBound[0]=A9+8;E8.upperBound[1]=B9+10;}function startNewGame(){h8.default.reseed();l8.default.deactivateAll();s8=q8;p8.default.publish('Height.Set',s8);t8=r8;p8.default.publish('Lives.Set',t8);x8=!1;u8=0;v8=q8-100;p8.default.publish('NextCheckpointHeight.Set',v8);0;o8.default.updateBodyPosition(D8,[0,s8]);n8.default.untintSprite(D8.sprite);n8.default.untintSprite(D8.spriteReflection);for(let i=0;i<A8.length;i++){n8.default.untintSprite(A8[i]);}C8.background.alpha=1;C8.container.alpha=1;if(z8){n8.default.untintTerrainObject(z8);z8=null;}C8.playerBallContainer.alpha=1;C8.sawContainer.alpha=1;C8.freeSawContainer.alpha=1;i8.default.stopAll();k8.default.hide();setState(g8.default.Active);}function setState(C9){G8=C9;const D9=G8===g8.default.Active;j8.default.view.className=D9?'playing-field':'';p8.default.publish('State.IsActive',D9);}p8.default.subscribe('Menu.Shown',()=>{C8.background.visible=!1;C8.container.visible=!1;C8.windLeft.visible=!1;C8.windRight.visible=!1;i8.default.pauseAll();H8=G8;setState(g8.default.Menu);});p8.default.subscribe('Menu.Hidden',()=>{C8.background.visible=!0;if(G8===g8.default.Intro){C8.terrainContainer.visible=!0;startNewGame();}else{C8.container.visible=!0;i8.default.resumeAll();setState(H8);}});p8.default.subscribe('Menu.RequestRestartGame',()=>{C8.background.visible=!0;C8.container.visible=!0;startNewGame();});p8.default.subscribe('Ball.CollisionWithFatal',E9=>{if(!x8){z8=E9.terrainObject;n8.default.tintSprite(D8.sprite,m8.default.red);n8.default.tintSprite(D8.spriteReflection,m8.default.red);n8.default.tintTerrainObject(z8,m8.default.red);lostLife(E9);}});p8.default.subscribe('Ball.CollisionWithPlusOne',()=>{t8++;p8.default.publish('Lives.Set',t8);i8.default.play('gainedLife');});p8.default.subscribe('Ball.CollisionWithGround',()=>{gameWon();});Object.defineProperty(e8,"__esModule",{value:!0});e8.default={initialize};},function(F9,G9,H9){"use strict";const I9=H9(23),J9=H9(4);function buildPixiGraph(K9,L9){const M9=new PIXI.Container(),N9=new PIXI.Sprite(K9.clouds);N9.scale.x=N9.scale.y=2;N9.anchor.x=N9.anchor.y=0.5;N9.visible=!1;const O9=new PIXI.Container(),P9=new PIXI.Container(),Q9=new PIXI.Container(),R9=new PIXI.Container(),S9=new PIXI.Container(),T9=new PIXI.Container(),U9=new PIXI.Container(),V9=new PIXI.Container(),W9=new PIXI.Container(),X9=new PIXI.Container(),Y9=new PIXI.Container(),Z9=new PIXI.Container(),a10=new PIXI.Container(),b10=0.75,c10=new PIXI.Sprite(K9.windLeft);c10.anchor.x=c10.anchor.y=0.5;c10.position.x=256;c10.position.y=567;c10.alpha=b10;c10.visible=!1;const d10=new PIXI.Sprite(K9.windRight);d10.anchor.x=d10.anchor.y=0.5;d10.position.x=768;d10.position.y=567;d10.alpha=b10;d10.visible=!1;const e10=new PIXI.Container();e10.interactive=!0;e10.hitArea=new PIXI.Rectangle(-10000000,-10000000,20000000,20000000);P9.addChild(Q9);P9.addChild(R9);P9.addChild(S9);P9.addChild(T9);P9.addChild(W9);P9.addChild(Y9);P9.addChild(Z9);P9.addChild(U9);P9.addChild(V9);P9.addChild(X9);P9.addChild(a10);O9.addChild(P9);O9.addChild(e10);const f10=I9.default(K9,L9);M9.addChild(N9);M9.addChild(O9);M9.addChild(c10);M9.addChild(d10);M9.addChild(f10);J9.default.subscribe('IsInvincible.Set',g10=>{U9.alpha=g10?0.5:1;V9.alpha=g10?0.5:1;});return{stage:M9,container:O9,terrainContainer:P9,barContainer:e10,girderContainer:Q9,brickContainer:R9,seesawContainer:S9,spinnerContainer:T9,sawContainer:U9,freeSawContainer:V9,twoByFourContainer:W9,playerBallContainer:X9,ballContainer:Y9,ballReflectionsContainer:Z9,plus1LifeContainer:a10,background:N9,windLeft:c10,windRight:d10};}Object.defineProperty(G9,"__esModule",{value:!0});G9.default=buildPixiGraph;},function(h10,i10,j10){"use strict";const k10=j10(2),l10=j10(0),m10=j10(7),n10=j10(4);let o10;function initialize(p10,q10,r10){o10=new p2.Body({mass:0.5});o10.allowSleep=!1;const s10=new p2.Circle({radius:1});s10.material=l10.default.ball;o10.addShape(s10);const t10=new PIXI.Sprite(r10.ball);t10.anchor=new PIXI.ObservablePoint(null,null,0.5,0.5);t10.tint=t10.originalTint=m10.default.blue;q10.playerBallContainer.addChild(t10);o10.sprite=t10;const u10=new PIXI.Sprite(r10.ballReflections);u10.alpha=0.5;u10.anchor=new PIXI.ObservablePoint(null,null,0.5,0.5);q10.playerBallContainer.addChild(u10);o10.spriteReflection=u10;p10.addBody(o10);p10.on('beginContact',beginContact,this);return o10;}function beginContact(v10){const w10=v10.bodyA,x10=v10.bodyB;if(w10===o10||x10===o10){const y10=w10===o10?x10:w10;if(y10.isFatal){n10.default.publish('Ball.CollisionWithFatal',y10);return;}else if(y10.isGround){n10.default.publish('Ball.CollisionWithGround');return;}else if(y10.terrainObject&&y10.terrainObject.type===k10.default.Plus1Life){y10.terrainObject.deactivate();n10.default.publish('Ball.CollisionWithPlusOne');}}}Object.defineProperty(i10,"__esModule",{value:!0});i10.default={initialize};},function(z10,A10,B10){"use strict";var C10=new Promise((D10,E10)=>{D10();});Object.defineProperty(A10,"__esModule",{value:!0});A10.default=C10;},function(F10,G10,H10){"use strict";const I10=H10(0);function createWorld(){const J10=new p2.World({gravity:[0,-4.9]});J10.solver=new p2.GSSolver({tolerance:0.01,iterations:10});J10.sleepMode=p2.World.BODY_SLEEPING;addContactMaterials(J10);return J10;}function addContactMaterials(K10){K10.addContactMaterial(new p2.ContactMaterial(I10.default.wood,I10.default.wood,{restitution:0.1,stiffness:Number.MAX_VALUE,friction:0.3,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.wood,I10.default.saw,{restitution:0.3,stiffness:Number.MAX_VALUE,friction:0.6,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.wood,I10.default.brick,{restitution:0.1,stiffness:Number.MAX_VALUE,friction:0.6,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.wood,I10.default.ball,{restitution:0.4,stiffness:Number.MAX_VALUE,friction:0.3,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.brick,I10.default.brick,{restitution:0,stiffness:Number.MAX_VALUE,friction:0.8,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.brick,I10.default.ball,{restitution:0.5,stiffness:Number.MAX_VALUE,friction:0.4,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.brick,I10.default.saw,{restitution:0.3,stiffness:Number.MAX_VALUE,friction:0.4,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));K10.addContactMaterial(new p2.ContactMaterial(I10.default.saw,I10.default.saw,{restitution:0.4,stiffness:Number.MAX_VALUE,friction:0.8,relaxation:void 0,frictionStiffness:void 0,frictionRelaxation:void 0,surfaceVelocity:void 0}));}Object.defineProperty(G10,"__esModule",{value:!0});G10.default=createWorld;},function(L10,M10,N10){"use strict";var O10;(function(P10){P10[P10["PageHidden"]=0]="PageHidden";P10[P10["Intro"]=1]="Intro";P10[P10["Active"]=2]="Active";P10[P10["Dying"]=3]="Dying";P10[P10["Menu"]=4]="Menu";P10[P10["Won"]=5]="Won";P10[P10["Lost"]=6]="Lost";P10[P10["DemoEnd"]=7]="DemoEnd";})(O10||(O10={}));Object.defineProperty(M10,"__esModule",{value:!0});M10.default=O10;},function(Q10,R10,S10){"use strict";const T10=S10(7),U10=S10(11),V10=S10(33),W10=S10(4),X10=U10.default.width,Y10=U10.default.height,Z10=X10/2,a11=getTextStyle(0.5),b11=getTextStyle(0.6),c11=getTextStyle(0.7),d11=getTextStyle(0.8),e11=getTextStyle(1);function buildNavContainer(f11,g11){const h11=new PIXI.Container(),i11=buildNavBackground(f11),j11=buildIntroPanel(f11),k11=buildMenuPanel(g11),l11=buildHelpPanel(f11),m11=buildAboutPanel(),n11=buildDemoEndPanel(),o11=buildTopMenu(f11);h11.addChild(i11);h11.addChild(o11);h11.addChild(k11);h11.addChild(j11);h11.addChild(l11);h11.addChild(m11);h11.addChild(n11);W10.default.subscribe('Menu.IntroHidden',p11=>{i11.visible=!1;o11.visible=!0;W10.default.publish('Menu.RequestHide');});W10.default.subscribe('Menu.RequestShow',q11=>{o11.visible=!1;i11.visible=!0;k11.visible=!0;W10.default.publish('Menu.Shown');});W10.default.subscribe('Menu.RequestHide',r11=>{k11.visible=!1;i11.visible=!1;o11.visible=!0;W10.default.publish('Menu.Hidden');});W10.default.subscribe('Menu.RequestHelpPanel',s11=>{k11.visible=!1;l11.visible=!0;});W10.default.subscribe('Menu.RequestAboutPanel',t11=>{k11.visible=!1;m11.visible=!0;});W10.default.subscribe('Menu.PanelHidden',u11=>{k11.visible=!0;});W10.default.subscribe('Menu.RequestDemoEndPanel',v11=>{o11.visible=!1;k11.visible=!1;i11.visible=!0;n11.visible=!0;});return h11;}function getTextStyle(w11){return{font:{name:'Constantia',size:128*w11},tint:T10.default.yellow};}function buildText(x11,y11){const z11=y11.style||b11,A11=new PIXI.extras.BitmapText(x11,z11);if(y11.left){A11.position.x=Math.round(y11.left);}else if(y11.right){A11.position.x=Math.round(y11.right-A11.width);}else if(y11.xCenter){A11.position.x=Math.round(y11.xCenter-A11.width/2);}if(y11.top){A11.position.y=Math.round(y11.top);}else if(y11.bottom){A11.position.y=Math.round(y11.bottom-A11.height);}else if(y11.yCenter){A11.position.y=Math.round(y11.yCenter-A11.height/2);}if(y11.callback){A11.interactive=!0;A11.buttonMode=!0;const highlight=e=>{const B11=e.currentTarget;B11.tint=T10.default.orange;},unhighlight=e=>{const C11=e.currentTarget;C11.tint=T10.default.yellow;};A11.on('mousedown',e=>{highlight(e);}).on('touchstart',e=>{highlight(e);});A11.on('mouseup',e=>{unhighlight(e);y11.callback();}).on('mouseupoutside',e=>{unhighlight(e);}).on('touchend',e=>{unhighlight(e);y11.callback();}).on('touchendoutside',e=>{unhighlight(e);});}return A11;}function buildHelpContent(D11){const E11=new PIXI.Container(),F11=c11,G11=buildText('Guide the ball to the ground',{xCenter:Z10,yCenter:320,style:F11});E11.addChild(G11);const H11=buildText('by drawing bars, like this:',{xCenter:Z10,yCenter:420,style:F11});E11.addChild(H11);const I11=new PIXI.Sprite(D11.helpHand);I11.anchor.x=I11.anchor.y=0.5;I11.position.x=512;I11.position.y=665;E11.addChild(I11);const J11=buildText('Avoid saws:',{xCenter:Z10,yCenter:850,style:F11});E11.addChild(J11);const K11=new PIXI.Sprite(D11.saw);K11.anchor.x=K11.anchor.y=0.5;K11.position.x=512;K11.position.y=1000;E11.addChild(K11);const L11=buildText('Collect extra lives:',{xCenter:Z10,yCenter:1150,style:F11});E11.addChild(L11);const M11=new PIXI.Sprite(D11.plus1Life);M11.anchor.x=M11.anchor.y=0.5;M11.position.x=512;M11.position.y=1280;E11.addChild(M11);const N11=buildText('Beat the timer.',{xCenter:Z10,yCenter:1420,style:F11});E11.addChild(N11);return E11;}function buildNavBackground(O11){const P11=new PIXI.Sprite(O11.clouds);P11.scale.x=P11.scale.y=2;P11.anchor.x=P11.anchor.y=0.5;P11.alpha=0.8;return P11;}function buildTopMenu(Q11){const R11=new PIXI.Container();R11.visible=!1;const S11=buildText('Height',{left:100,top:16});R11.addChild(S11);const T11=buildText(getHeightText(1000),{left:S11.position.x+S11.width+16,top:16});R11.addChild(T11);W10.default.subscribe('Height.Set',U11=>{T11.text=getHeightText(U11);});const V11=buildText('Lives: 9:',{left:0,top:0}),W11=buildText('Lives:',{left:X10*0.625-V11.width/2,top:16});R11.addChild(W11);const X11=buildText(10 .toString(),{left:W11.position.x+W11.width+16,top:16});R11.addChild(X11);W10.default.subscribe('Lives.Set',Y11=>{X11.text=Y11.toString();});const Z11=buildText('Menu',{right:X10-32,top:16,callback:()=>{W10.default.publish('Menu.RequestShow');}});R11.addChild(Z11);const a12=buildText(getTimeRemainingText(900),{left:32,top:106,style:a11});R11.addChild(a12);W10.default.subscribe('NextCheckpointHeight.Set',b12=>{a12.text=getTimeRemainingText(b12);});const c12=new PIXI.Sprite(Q11.timeBar);c12.position.x=392;c12.position.y=128;R11.addChild(c12);const d12=new PIXI.Sprite(Q11.timeBarTime);d12.position.x=394;d12.position.y=130;d12.alpha=0.85;R11.addChild(d12);W10.default.subscribe('TimeRemainingQuotient.Set',e12=>{d12.width=e12*596;d12.tint=V10.default(T10.default.yellow,T10.default.red,e12);if(e12<=0){a12.tint=T10.default.red;}else{a12.tint=T10.default.yellow;}});return R11;}function buildIntroPanel(f12){const g12=new PIXI.Container();g12.addChild(buildHelpContent(f12));g12.addChild(buildText('Start >',{xCenter:Z10,yCenter:Y10*0.92,style:e11,callback:()=>{g12.visible=!1;W10.default.publish('Menu.IntroHidden');}}));return g12;}function getHeightText(h12){return h12+'m';}function getTimeRemainingText(i12){return'Time to '+i12.toString()+'m:';}function getSoundText(j12){return'Sound '+(j12?'on':'off');}function buildMenuPanel(k12){const l12=new PIXI.Container(),m12=Y10/5,n12=d11,o12=buildText(getSoundText(k12),{xCenter:Z10,yCenter:m12,style:n12,callback:k12?()=>{W10.default.publish('Sound.Toggle');}:null});if(k12){W10.default.subscribe('Sound.Enable',p12=>{o12.text=getSoundText(p12);});}else{o12.alpha=0.5;}l12.addChild(o12);l12.addChild(buildText('Help',{xCenter:Z10,yCenter:m12*2,style:n12,callback:()=>{W10.default.publish('Menu.RequestHelpPanel');}}));l12.addChild(buildText('About',{xCenter:Z10,yCenter:m12*3,style:n12,callback:()=>{W10.default.publish('Menu.RequestAboutPanel');}}));l12.addChild(buildText('Return to game',{xCenter:Z10,yCenter:m12*4,style:n12,callback:()=>{W10.default.publish('Menu.RequestHide');}}));l12.visible=!1;return l12;}function buildBackButton(q12){return buildText('< Back',{xCenter:Z10,yCenter:Y10*0.92,style:e11,callback:()=>{q12.visible=!1;W10.default.publish('Menu.PanelHidden');}});}function buildHelpPanel(r12){const s12=new PIXI.Container();s12.addChild(buildHelpContent(r12));s12.addChild(buildBackButton(s12));s12.visible=!1;return s12;}function buildAboutPanel(){const t12=new PIXI.Container(),u12=buildText('Descensus 2',{xCenter:Z10,yCenter:600,style:d11});t12.addChild(u12);const v12=buildText('v1.0.2',{xCenter:Z10,yCenter:700,style:c11});t12.addChild(v12);const w12=buildText('By Tom W Hall',{xCenter:Z10,yCenter:900});t12.addChild(w12);const x12=buildText('Boolean Operations Limited',{xCenter:Z10,yCenter:1000});t12.addChild(x12);const y12=buildText('http://booleanoperations.com',{xCenter:Z10,yCenter:1100});t12.addChild(y12);t12.addChild(buildBackButton(t12));t12.visible=!1;return t12;}function buildDemoEndPanel(){const z12=d11,A12=new PIXI.Container();A12.addChild(buildText('Thanks for playing!',{xCenter:Z10,yCenter:Y10*0.5,style:z12}));A12.visible=!1;return A12;}Object.defineProperty(R10,"__esModule",{value:!0});R10.default=buildNavContainer;},function(B12,C12,D12){"use strict";const E12=D12(2),F12=D12(3),G12=D12(0),H12=D12(1);class Brick extends F12.default{constructor(I12,J12,K12){super(E12.default.Brick,I12,J12);const L12=new p2.Body({mass:1});L12.allowSleep=!1;const M12=new PIXI.Sprite(K12.brick);this.addBody(L12,M12,J12.brickContainer);const N12=new p2.Box({width:2,height:0.625});N12.material=G12.default.brick;this.addShape(L12,N12);}activate(O12,P12){super.activate();H12.default.updateBodyPosition(this.bodies[0],O12,P12);}}Object.defineProperty(C12,"__esModule",{value:!0});C12.default=Brick;},function(Q12,R12,S12){"use strict";const T12=S12(3),U12=S12(2),V12=S12(0),W12=S12(1);class FreeSaw extends T12.default{constructor(X12,Y12,Z12){super(U12.default.FreeSaw,X12,Y12);const a13=this.sawBody=new p2.Body({mass:0.5});a13.damping=0.5;a13.isFatal=!0;a13.allowSleep=!1;const b13=new PIXI.Sprite(Z12.sawSmall);this.addBody(a13,b13,Y12.freeSawContainer);const c13=new p2.Circle({radius:0.75});c13.material=V12.default.saw;this.addShape(a13,c13);}activate(d13,e13){super.activate();W12.default.updateBodyPosition(this.sawBody,d13);this.sawBody.angularVelocity=-2;if(e13){this.sawBody.velocity=e13;}}}Object.defineProperty(R12,"__esModule",{value:!0});R12.default=FreeSaw;},function(f13,g13,h13){"use strict";const i13=h13(2),j13=h13(3),k13=h13(0),l13=h13(1);class Girder extends j13.default{constructor(m13,n13,o13){super(i13.default.Girder,m13,n13);const p13=new p2.Body({mass:30});p13.gravityScale=0;const q13=new PIXI.Sprite(o13.girder);this.addBody(p13,q13,n13.girderContainer);const r13=new p2.Box({width:4,height:1});r13.material=k13.default.wood;this.addShape(p13,r13);}activate(s13,t13){super.activate();l13.default.updateBodyPosition(this.bodies[0],s13,t13);}}Object.defineProperty(g13,"__esModule",{value:!0});g13.default=Girder;},function(u13,v13,w13){"use strict";const x13=w13(3),y13=w13(2),z13=w13(0),A13=w13(1);class Plus1Life extends x13.default{constructor(B13,C13,D13){super(y13.default.Plus1Life,B13,C13);const E13=this.plus1LifeBody=new p2.Body({mass:0.5});E13.allowSleep=!1;E13.damping=0.8;const F13=new PIXI.Sprite(D13.plus1Life);this.addBody(E13,F13,C13.plus1LifeContainer);const G13=new p2.Box({width:2,height:1.203125});G13.material=z13.default.wood;this.addShape(E13,G13);}activate(H13){super.activate();A13.default.updateBodyPosition(this.plus1LifeBody,H13);}}Object.defineProperty(v13,"__esModule",{value:!0});v13.default=Plus1Life;},function(I13,J13,K13){"use strict";const L13=K13(3),M13=K13(2),N13=K13(0),O13=K13(5),P13=K13(1);class Saw extends L13.default{constructor(Q13,R13,S13){super(M13.default.Saw,Q13,R13);this.speed=-6;const T13=this.sawBody=new p2.Body({mass:1});T13.gravityScale=0;T13.isFatal=!0;const U13=new PIXI.Sprite(S13.saw);this.addBody(T13,U13,R13.sawContainer);const V13=new p2.Circle({radius:1});V13.material=N13.default.saw;this.addShape(T13,V13);const W13=this.anchorBody=O13.default.getAnchor(T13);this.addBodyHidden(W13);const X13=O13.default.getAnchorConstraint(T13,W13,null,!0);X13.setMotorSpeed(this.speed);this.addConstraint(X13);}activate(Y13){super.activate();P13.default.updateBodyPosition(this.sawBody,Y13);P13.default.updateBodyPosition(this.anchorBody,Y13);}}Object.defineProperty(J13,"__esModule",{value:!0});J13.default=Saw;},function(Z13,a14,b14){"use strict";const c14=b14(12),d14=b14(2),e14=b14(6),f14=b14(0),g14=b14(1);class SawSnake extends c14.default{constructor(h14,i14,j14,k14,l14){super(h14,i14,j14,k14,l14);this.sawSpeed=-6;this.sawBodies=[];this.type=d14.default.SawSnake;const m14=this.segments;for(let i=0;i<m14.length;i++){const n14=m14[i];this.addSaw(n14,j14);}}addSaw(o14,p14){const q14=new p2.Body({mass:1,position:[o14.position[0],o14.position[1]],angle:e14.default.random0To1()*(2*Math.PI)});q14.gravityScale=0;q14.isFatal=!0;const r14=new PIXI.Sprite(p14.saw);this.addBody(q14,r14,this.pixiGraph.sawContainer);this.sawBodies.push(q14);const s14=new p2.Circle({radius:1});s14.material=f14.default.wood;this.addShape(q14,s14);const t14=new p2.RevoluteConstraint(q14,o14,{localPivotA:[0,0],localPivotB:[0,0]});t14.enableMotor();t14.setMotorSpeed(this.sawSpeed);t14.collideConnected=!1;this.addConstraint(t14);}activate(u14,v14,w14){super.activate(u14,v14,w14);const x14=this.segments,y14=this.sawBodies;for(let i=0;i<x14.length;i++){const z14=x14[i].position,A14=y14[i];g14.default.updateBodyPosition(A14,[z14[0],z14[1]]);}}}Object.defineProperty(a14,"__esModule",{value:!0});a14.default=SawSnake;},function(B14,C14,D14){"use strict";const E14=D14(13),F14=D14(2),G14=D14(0),H14=D14(1);class SawSpinner extends E14.default{constructor(I14,J14,K14){super(I14,J14,K14);this.sawSpeed=-6;this.sawOffsets=[[0,2.5],[0,-2.5],[-2.5,0],[2.5,0]];this.sawBodies=[];this.type=F14.default.SawSpinner;const L14=this.spinnerBody,M14=this.sawOffsets;for(let i=0;i<M14.length;i++){this.addSaw(L14,M14[i],K14);}}addSaw(N14,O14,P14){const Q14=N14.position,R14=new p2.Body({mass:1,position:[Q14[0]+O14[0],Q14[1]+O14[1]]});R14.gravityScale=0;R14.isFatal=!0;const S14=new PIXI.Sprite(P14.saw);this.addBody(R14,S14,this.pixiGraph.sawContainer);this.sawBodies.push(R14);const T14=new p2.Circle({radius:1});T14.material=G14.default.wood;this.addShape(R14,T14);const U14=new p2.RevoluteConstraint(R14,N14,{localPivotA:[0,0],localPivotB:O14});U14.enableMotor();U14.setMotorSpeed(this.sawSpeed);U14.collideConnected=!1;this.addConstraint(U14);}setSawPositions(V14){const W14=this.sawBodies,X14=this.sawOffsets;for(let i=0;i<X14.length;i++){const Y14=X14[i];H14.default.updateBodyPosition(W14[i],[V14[0]+Y14[0],V14[1]+Y14[1]]);}}activate(Z14,a15){super.activate(Z14,a15);this.setSawPositions(Z14);}}Object.defineProperty(C14,"__esModule",{value:!0});C14.default=SawSpinner;},function(b15,c15,d15){"use strict";const e15=d15(3),f15=d15(2),g15=d15(0),h15=d15(5),i15=d15(1);class Seesaw extends e15.default{constructor(j15,k15,l15){super(f15.default.Seesaw,j15,k15);const m15=new p2.Body({mass:3});m15.gravityScale=0;const n15=new PIXI.Sprite(l15.seesaw);this.addBody(m15,n15,k15.seesawContainer);const o15=new p2.Box({width:6,height:1});o15.material=g15.default.wood;this.addShape(m15,o15);const p15=h15.default.getAnchor(m15);this.addBodyHidden(p15);this.addConstraint(h15.default.getAnchorConstraint(m15,p15));}activate(q15,r15=!1){super.activate();const s15=this.bodies;for(let i=0;i<s15.length;i++){const t15=this.bodies[i],u15=r15?-Math.PI/2:0;i15.default.updateBodyPosition(t15,q15,u15);}}}Object.defineProperty(c15,"__esModule",{value:!0});c15.default=Seesaw;},function(v15,w15,x15){"use strict";const y15=x15(6);function getRandomPosition(z15,A15,B15,C15,D15){const E15=10;let F15=0;const G15=A15.lowerBound[0]+B15/2,H15=A15.upperBound[0]-B15/2,I15=A15.lowerBound[1]+C15/2,J15=A15.upperBound[1]-C15/2;while(F15<E15){F15++;const x=y15.default.randomInt(G15,H15),y=y15.default.randomInt(I15,J15),K15=[x,y];if(!isBlocked(z15,K15,B15+D15,C15+D15)){return K15;}}return null;}function getMidHeight(L15){return(L15.lowerBound[1]+L15.upperBound[1])/2;}function getCountMoreAsDescends(M15,min,max,P15){if(M15>P15)return 0;const Q15=(P15-M15)/P15,R15=Math.round(min+Q15*(max-min));return R15;}function getCountLessAsDescends(S15,min,max,V15){if(S15>V15)return 0;const W15=(V15-S15)/V15,X15=Math.round(min+(1-W15)*(max-min));return X15;}function updateAABBs(Y15){const Z15=Y15.bodies;for(let i=0;i<Z15.length;i++){const a16=Z15[i];if(a16.aabbNeedsUpdate){a16.updateAABB();}}}function isBlocked(b16,c16,d16,e16){const f16=d16/2,g16=e16/2,h16=b16.bodies;for(let i=0;i<h16.length;i++){const i16=h16[i],j16=i16.aabb;if(!(j16.upperBound[0]<c16[0]-f16||j16.lowerBound[0]>c16[0]+f16||j16.upperBound[1]<c16[1]-g16||j16.lowerBound[1]>c16[1]+g16)){return!0;}}return!1;}Object.defineProperty(w15,"__esModule",{value:!0});w15.default={getRandomPosition,getMidHeight,getCountMoreAsDescends,getCountLessAsDescends,updateAABBs};},function(k16,l16,m16){"use strict";function blendColors(n16,o16,p16){var hex=function(num){const r16=num.toString(16);return r16.length===1?'0'+r16:r16;};const s16=hex(n16),t16=hex(o16),r=Math.ceil(parseInt(s16.substring(0,2),16)*p16+parseInt(t16.substring(0,2),16)*(1-p16)),g=Math.ceil(parseInt(s16.substring(2,4),16)*p16+parseInt(t16.substring(2,4),16)*(1-p16)),b=Math.ceil(parseInt(s16.substring(4,6),16)*p16+parseInt(t16.substring(4,6),16)*(1-p16)),u16=hex(r)+hex(g)+hex(b);return parseInt(u16,16);}Object.defineProperty(l16,"__esModule",{value:!0});l16.default=blendColors;},function(v16,w16,x16){"use strict";function tintTerrainObject(y16,z16){const A16=y16.bodies;for(let i=0;i<A16.length;i++){const B16=A16[i];tintSprite(B16.sprite,z16);tintSprite(B16.spriteReflection,z16);}}function untintTerrainObject(C16){const D16=C16.bodies;for(let i=0;i<D16.length;i++){const E16=D16[i];untintSprite(E16.sprite);untintSprite(E16.spriteReflection);}}function tintSprite(F16,G16){if(F16){F16.tint=G16;}}function untintSprite(H16){if(H16){H16.tint=H16.originalTint||0xffffff;}}Object.defineProperty(w16,"__esModule",{value:!0});w16.default={tintTerrainObject,untintTerrainObject,tintSprite,untintSprite};},function(I16,J16,K16){"use strict";const L16=K16(20),M16=K16(16),N16=K16(15),O16=K16(14),P16=K16(21),Q16=K16(18),R16=K16(9),S16=K16(19),T16=K16(10),U16=K16(8),V16=K16(17);L16.default.then(()=>{let W16=!1;N16.default.then(X16=>{W16=!0;U16.default.initialize(X16);}).catch(Y16=>{}).then(()=>{Promise.all([M16.default,O16.default]).then(Z16=>{const a17=Z16[0],b17=P16.default(),c17=Q16.default(a17,W16);R16.default.initialize(b17,c17,a17);const d17=S16.default.initialize(b17,c17,a17);T16.default.initialize(b17,c17,a17);document.getElementById('loading').style.display='none';document.getElementById('viewport').style.display='block';V16.default.initialize(b17,c17,d17);});});});}]);